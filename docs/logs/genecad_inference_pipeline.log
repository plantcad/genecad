Running prediction pipeline for INPUT_FILE=data/Arabidopsis_thaliana.TAIR10.dna.chromosome.4.fa.gz
python scripts/extract.py extract_fasta_file \
  --species-id athaliana \
  --fasta-file data/Arabidopsis_thaliana.TAIR10.dna.chromosome.4.fa.gz \
  --chrom-map "4:4" \
  --tokenizer-path kuleshov-group/PlantCAD2-Large-l48-d1536 \
  --output results/pipeline/sequences.zarr
2025-09-12 19:23:13,559 - INFO - Parsed chromosome mapping: {'4': '4'}
2025-09-12 19:23:20,075 - INFO - Loading tokenizer from kuleshov-group/PlantCAD2-Large-l48-d1536
2025-09-12 19:23:20,545 - INFO - Vectorizing token map: {'c': 4, 'C': 4, 'g': 5, 'G': 5, 'a': 3, 'A': 3, 't': 6, 'T': 6, 'm': 2, 'M': 2, 'r': 2, 'R': 2, 'w': 2, 'W': 2, 's': 2, 'S': 2, 'y': 2, 'Y': 2, 'k': 2, 'K': 2, 'v': 2, 'V': 2, 'h': 2, 'H': 2, 'd': 2, 'D': 2, 'b': 2, 'B': 2, 'x': 2, 'X': 2, 'n': 2, 'N': 2}
2025-09-12 19:23:20,545 - INFO - [species=athaliana] Processing FASTA file: data/Arabidopsis_thaliana.TAIR10.dna.chromosome.4.fa.gz
2025-09-12 19:23:20,843 - INFO - [species=athaliana] Added 4 (from 4), length: 18585056
2025-09-12 19:23:20,844 - INFO - [species=athaliana] Found 1 total chromosomes
2025-09-12 19:23:20,844 - INFO - [species=athaliana] Processing chromosome: 4
2025-09-12 19:23:22,437 - INFO - [species=athaliana] Creating dataset...
2025-09-12 19:23:22,464 - INFO - [species=athaliana] Tokenizing forward strand: NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN ...
2025-09-12 19:23:24,030 - INFO - [species=athaliana] Token ID frequencies: {3: 5940546, 6: 5914038, 4: 3371349, 5: 3356091, 2: 3032}
2025-09-12 19:23:24,047 - INFO - [species=athaliana] Tokenizing reverse strand: NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN ...
2025-09-12 19:23:25,612 - INFO - [species=athaliana] Token ID frequencies: {6: 5940546, 3: 5914038, 5: 3371349, 4: 3356091, 2: 3032}
2025-09-12 19:23:25,707 - INFO - [species=athaliana] Saving 4 dataset to results/pipeline/sequences.zarr
2025-09-12 19:23:27,729 - INFO - [species=athaliana] Saved 1 chromosome sequences to results/pipeline/sequences.zarr
2025-09-12 19:23:27,897 - INFO - Final data tree:
<xarray.DataTree>
Group: /
└── Group: /athaliana
    └── Group: /athaliana/4
            Dimensions:             (strand: 2, sequence: 18585056)
            Coordinates:
              * sequence            (sequence) int64 149MB 0 1 2 ... 18585054 18585055
              * strand              (strand) <U8 64B 'positive' 'negative'
            Data variables:
                sequence_masks      (strand, sequence) bool 37MB ...
                sequence_input_ids  (strand, sequence) int64 297MB ...
                sequence_tokens     (strand, sequence) |S1 37MB ...
            Attributes:
                species_id:     athaliana
                chromosome_id:  4
2025-09-12 19:23:27,898 - INFO - Done
python scripts/predict.py create_predictions \
  --input results/pipeline/sequences.zarr \
  --output-dir results/pipeline/predictions.zarr \
  --model-path kuleshov-group/PlantCAD2-Large-l48-d1536 \
  --model-checkpoint plantcad/GeneCAD-l8-d768-PC2-Large \
  --species-id athaliana \
  --chromosome-id 4 \
  --batch-size 32 \
  --dtype bfloat16
2025-09-12 19:23:35,239 - INFO - Loading model from plantcad/GeneCAD-l8-d768-PC2-Large
2025-09-12 19:23:35,240 - INFO - Local path for classifier plantcad/GeneCAD-l8-d768-PC2-Large not found; attempting Hugging Face download ...
2025-09-12 19:23:41,534 - INFO - Downloaded classifier to /root/.cache/huggingface/hub/models--plantcad--GeneCAD-l8-d768-PC2-Large/snapshots/0c0f7b4cdd7b381f794d5816ec40bc539e4f7a8b/model.ckpt
A new version of the following files was downloaded from https://huggingface.co/kuleshov-group/PlantCAD2-Large-l48-d1536:
- configuration_caduceus.py
. Make sure to double-check they do not contain any added malicious code. To avoid downloading new versions of the code file, you can pin a revision.
A new version of the following files was downloaded from https://huggingface.co/kuleshov-group/PlantCAD2-Large-l48-d1536:
- modeling_rcps.py
. Make sure to double-check they do not contain any added malicious code. To avoid downloading new versions of the code file, you can pin a revision.
A new version of the following files was downloaded from https://huggingface.co/kuleshov-group/PlantCAD2-Large-l48-d1536:
- modeling_caduceus.py
- modeling_rcps.py
. Make sure to double-check they do not contain any added malicious code. To avoid downloading new versions of the code file, you can pin a revision.
2025-09-12 19:23:56,628 - INFO - Loading tokenizer from kuleshov-group/PlantCAD2-Large-l48-d1536
2025-09-12 19:23:56,682 - INFO - Opening input sequence datatree from results/pipeline/sequences.zarr
2025-09-12 19:23:56,852 - INFO - Input sequences:
<xarray.DataTree>
Group: /
└── Group: /athaliana
    └── Group: /athaliana/4
            Dimensions:             (strand: 2, sequence: 18585056)
            Coordinates:
              * sequence            (sequence) int64 149MB 0 1 2 ... 18585054 18585055
              * strand              (strand) <U8 64B 'positive' 'negative'
            Data variables:
                sequence_masks      (strand, sequence) bool 37MB ...
                sequence_input_ids  (strand, sequence) int64 297MB ...
                sequence_tokens     (strand, sequence) |S1 37MB ...
            Attributes:
                species_id:     athaliana
                chromosome_id:  4
2025-09-12 19:23:56,853 - INFO - Selecting data for species 'athaliana' and chromosome '4'
2025-09-12 19:23:56,853 - INFO - Loaded dataset with dimensions: {'strand': 2, 'sequence': 18585056}
2025-09-12 19:23:56,853 - INFO - Running predictions for athaliana/4
2025-09-12 19:23:56,853 - INFO - Generating predictions with args.batch_size=32, args.window_size=8192, args.stride=4096 (rank=0, world_size=1)
2025-09-12 19:23:56,853 - INFO - Using pad_value=2 (UNK token) for sequence padding
2025-09-12 19:23:56,853 - INFO - Processing strand: positive
2025-09-12 19:23:58,165 - INFO - Processing 4537 windows in 141 batches of size 32
2025-09-12 19:23:58,165 - INFO - Processing batch 1 of 141 [rank=0, world_size=1]
2025-09-12 19:24:33,149 - INFO - Processing batch 2 of 141 [rank=0, world_size=1]
2025-09-12 19:24:39,027 - INFO - Processing batch 3 of 141 [rank=0, world_size=1]
2025-09-12 19:24:44,927 - INFO - Processing batch 4 of 141 [rank=0, world_size=1]
2025-09-12 19:24:50,836 - INFO - Processing batch 5 of 141 [rank=0, world_size=1]
2025-09-12 19:24:56,742 - INFO - Processing batch 6 of 141 [rank=0, world_size=1]
2025-09-12 19:25:02,657 - INFO - Processing batch 7 of 141 [rank=0, world_size=1]
2025-09-12 19:25:08,566 - INFO - Processing batch 8 of 141 [rank=0, world_size=1]
2025-09-12 19:25:14,475 - INFO - Processing batch 9 of 141 [rank=0, world_size=1]
2025-09-12 19:25:20,378 - INFO - Processing batch 10 of 141 [rank=0, world_size=1]
2025-09-12 19:25:26,288 - INFO - Processing batch 11 of 141 [rank=0, world_size=1]
2025-09-12 19:25:32,195 - INFO - Processing batch 12 of 141 [rank=0, world_size=1]
2025-09-12 19:25:38,106 - INFO - Processing batch 13 of 141 [rank=0, world_size=1]
2025-09-12 19:25:44,019 - INFO - Processing batch 14 of 141 [rank=0, world_size=1]
2025-09-12 19:25:49,936 - INFO - Processing batch 15 of 141 [rank=0, world_size=1]
2025-09-12 19:25:55,847 - INFO - Processing batch 16 of 141 [rank=0, world_size=1]
2025-09-12 19:26:01,762 - INFO - Processing batch 17 of 141 [rank=0, world_size=1]
2025-09-12 19:26:07,674 - INFO - Processing batch 18 of 141 [rank=0, world_size=1]
2025-09-12 19:26:13,586 - INFO - Processing batch 19 of 141 [rank=0, world_size=1]
2025-09-12 19:26:19,500 - INFO - Processing batch 20 of 141 [rank=0, world_size=1]
2025-09-12 19:26:25,417 - INFO - Processing batch 21 of 141 [rank=0, world_size=1]
2025-09-12 19:26:31,337 - INFO - Processing batch 22 of 141 [rank=0, world_size=1]
2025-09-12 19:26:37,254 - INFO - Processing batch 23 of 141 [rank=0, world_size=1]
2025-09-12 19:26:43,168 - INFO - Processing batch 24 of 141 [rank=0, world_size=1]
2025-09-12 19:26:49,080 - INFO - Processing batch 25 of 141 [rank=0, world_size=1]
2025-09-12 19:26:54,989 - INFO - Processing batch 26 of 141 [rank=0, world_size=1]
2025-09-12 19:27:01,800 - INFO - Processing batch 27 of 141 [rank=0, world_size=1]
2025-09-12 19:27:07,522 - INFO - Processing batch 28 of 141 [rank=0, world_size=1]
2025-09-12 19:27:13,248 - INFO - Processing batch 29 of 141 [rank=0, world_size=1]
2025-09-12 19:27:18,975 - INFO - Processing batch 30 of 141 [rank=0, world_size=1]
2025-09-12 19:27:24,707 - INFO - Processing batch 31 of 141 [rank=0, world_size=1]
2025-09-12 19:27:30,430 - INFO - Processing batch 32 of 141 [rank=0, world_size=1]
2025-09-12 19:27:36,159 - INFO - Processing batch 33 of 141 [rank=0, world_size=1]
2025-09-12 19:27:41,884 - INFO - Processing batch 34 of 141 [rank=0, world_size=1]
2025-09-12 19:27:47,611 - INFO - Processing batch 35 of 141 [rank=0, world_size=1]
2025-09-12 19:27:53,346 - INFO - Processing batch 36 of 141 [rank=0, world_size=1]
2025-09-12 19:27:59,075 - INFO - Processing batch 37 of 141 [rank=0, world_size=1]
2025-09-12 19:28:04,798 - INFO - Processing batch 38 of 141 [rank=0, world_size=1]
2025-09-12 19:28:10,524 - INFO - Processing batch 39 of 141 [rank=0, world_size=1]
2025-09-12 19:28:16,245 - INFO - Processing batch 40 of 141 [rank=0, world_size=1]
2025-09-12 19:28:21,966 - INFO - Processing batch 41 of 141 [rank=0, world_size=1]
2025-09-12 19:28:27,695 - INFO - Processing batch 42 of 141 [rank=0, world_size=1]
2025-09-12 19:28:33,430 - INFO - Processing batch 43 of 141 [rank=0, world_size=1]
2025-09-12 19:28:39,164 - INFO - Processing batch 44 of 141 [rank=0, world_size=1]
2025-09-12 19:28:44,893 - INFO - Processing batch 45 of 141 [rank=0, world_size=1]
2025-09-12 19:28:50,631 - INFO - Processing batch 46 of 141 [rank=0, world_size=1]
2025-09-12 19:28:56,360 - INFO - Processing batch 47 of 141 [rank=0, world_size=1]
2025-09-12 19:29:02,096 - INFO - Processing batch 48 of 141 [rank=0, world_size=1]
2025-09-12 19:29:07,828 - INFO - Processing batch 49 of 141 [rank=0, world_size=1]
2025-09-12 19:29:13,567 - INFO - Processing batch 50 of 141 [rank=0, world_size=1]
2025-09-12 19:29:19,299 - INFO - Processing batch 51 of 141 [rank=0, world_size=1]
2025-09-12 19:29:25,028 - INFO - Processing batch 52 of 141 [rank=0, world_size=1]
2025-09-12 19:29:30,758 - INFO - Processing batch 53 of 141 [rank=0, world_size=1]
2025-09-12 19:29:36,487 - INFO - Processing batch 54 of 141 [rank=0, world_size=1]
2025-09-12 19:29:42,213 - INFO - Processing batch 55 of 141 [rank=0, world_size=1]
2025-09-12 19:29:47,947 - INFO - Processing batch 56 of 141 [rank=0, world_size=1]
2025-09-12 19:29:53,676 - INFO - Processing batch 57 of 141 [rank=0, world_size=1]
2025-09-12 19:29:59,403 - INFO - Processing batch 58 of 141 [rank=0, world_size=1]
2025-09-12 19:30:05,125 - INFO - Processing batch 59 of 141 [rank=0, world_size=1]
2025-09-12 19:30:10,854 - INFO - Processing batch 60 of 141 [rank=0, world_size=1]
2025-09-12 19:30:16,583 - INFO - Processing batch 61 of 141 [rank=0, world_size=1]
2025-09-12 19:30:22,307 - INFO - Processing batch 62 of 141 [rank=0, world_size=1]
2025-09-12 19:30:28,043 - INFO - Processing batch 63 of 141 [rank=0, world_size=1]
2025-09-12 19:30:33,772 - INFO - Processing batch 64 of 141 [rank=0, world_size=1]
2025-09-12 19:30:39,507 - INFO - Processing batch 65 of 141 [rank=0, world_size=1]
2025-09-12 19:30:45,237 - INFO - Processing batch 66 of 141 [rank=0, world_size=1]
2025-09-12 19:30:50,964 - INFO - Processing batch 67 of 141 [rank=0, world_size=1]
2025-09-12 19:30:56,690 - INFO - Processing batch 68 of 141 [rank=0, world_size=1]
2025-09-12 19:31:02,421 - INFO - Processing batch 69 of 141 [rank=0, world_size=1]
2025-09-12 19:31:08,141 - INFO - Processing batch 70 of 141 [rank=0, world_size=1]
2025-09-12 19:31:13,858 - INFO - Processing batch 71 of 141 [rank=0, world_size=1]
2025-09-12 19:31:19,575 - INFO - Processing batch 72 of 141 [rank=0, world_size=1]
2025-09-12 19:31:25,299 - INFO - Processing batch 73 of 141 [rank=0, world_size=1]
2025-09-12 19:31:31,019 - INFO - Processing batch 74 of 141 [rank=0, world_size=1]
2025-09-12 19:31:36,736 - INFO - Processing batch 75 of 141 [rank=0, world_size=1]
2025-09-12 19:31:42,452 - INFO - Processing batch 76 of 141 [rank=0, world_size=1]
2025-09-12 19:31:48,177 - INFO - Processing batch 77 of 141 [rank=0, world_size=1]
2025-09-12 19:31:53,896 - INFO - Processing batch 78 of 141 [rank=0, world_size=1]
2025-09-12 19:31:59,619 - INFO - Processing batch 79 of 141 [rank=0, world_size=1]
2025-09-12 19:32:05,338 - INFO - Processing batch 80 of 141 [rank=0, world_size=1]
2025-09-12 19:32:11,065 - INFO - Processing batch 81 of 141 [rank=0, world_size=1]
2025-09-12 19:32:16,786 - INFO - Processing batch 82 of 141 [rank=0, world_size=1]
2025-09-12 19:32:22,513 - INFO - Processing batch 83 of 141 [rank=0, world_size=1]
2025-09-12 19:32:28,248 - INFO - Processing batch 84 of 141 [rank=0, world_size=1]
2025-09-12 19:32:33,972 - INFO - Processing batch 85 of 141 [rank=0, world_size=1]
2025-09-12 19:32:39,695 - INFO - Processing batch 86 of 141 [rank=0, world_size=1]
2025-09-12 19:32:45,428 - INFO - Processing batch 87 of 141 [rank=0, world_size=1]
2025-09-12 19:32:51,160 - INFO - Processing batch 88 of 141 [rank=0, world_size=1]
2025-09-12 19:32:56,887 - INFO - Processing batch 89 of 141 [rank=0, world_size=1]
2025-09-12 19:33:02,616 - INFO - Processing batch 90 of 141 [rank=0, world_size=1]
2025-09-12 19:33:08,348 - INFO - Processing batch 91 of 141 [rank=0, world_size=1]
2025-09-12 19:33:14,088 - INFO - Processing batch 92 of 141 [rank=0, world_size=1]
2025-09-12 19:33:19,817 - INFO - Processing batch 93 of 141 [rank=0, world_size=1]
2025-09-12 19:33:25,536 - INFO - Processing batch 94 of 141 [rank=0, world_size=1]
2025-09-12 19:33:31,267 - INFO - Processing batch 95 of 141 [rank=0, world_size=1]
2025-09-12 19:33:36,996 - INFO - Processing batch 96 of 141 [rank=0, world_size=1]
2025-09-12 19:33:42,725 - INFO - Processing batch 97 of 141 [rank=0, world_size=1]
2025-09-12 19:33:48,452 - INFO - Processing batch 98 of 141 [rank=0, world_size=1]
2025-09-12 19:33:54,176 - INFO - Processing batch 99 of 141 [rank=0, world_size=1]
2025-09-12 19:33:59,907 - INFO - Processing batch 100 of 141 [rank=0, world_size=1]
2025-09-12 19:34:05,633 - INFO - Processing batch 101 of 141 [rank=0, world_size=1]
2025-09-12 19:34:11,356 - INFO - Processing batch 102 of 141 [rank=0, world_size=1]
2025-09-12 19:34:17,086 - INFO - Processing batch 103 of 141 [rank=0, world_size=1]
2025-09-12 19:34:22,814 - INFO - Processing batch 104 of 141 [rank=0, world_size=1]
2025-09-12 19:34:28,543 - INFO - Processing batch 105 of 141 [rank=0, world_size=1]
2025-09-12 19:34:34,270 - INFO - Processing batch 106 of 141 [rank=0, world_size=1]
2025-09-12 19:34:40,003 - INFO - Processing batch 107 of 141 [rank=0, world_size=1]
2025-09-12 19:34:45,721 - INFO - Processing batch 108 of 141 [rank=0, world_size=1]
2025-09-12 19:34:51,444 - INFO - Processing batch 109 of 141 [rank=0, world_size=1]
2025-09-12 19:34:57,167 - INFO - Processing batch 110 of 141 [rank=0, world_size=1]
2025-09-12 19:35:02,896 - INFO - Processing batch 111 of 141 [rank=0, world_size=1]
2025-09-12 19:35:08,627 - INFO - Processing batch 112 of 141 [rank=0, world_size=1]
2025-09-12 19:35:14,358 - INFO - Processing batch 113 of 141 [rank=0, world_size=1]
2025-09-12 19:35:20,088 - INFO - Processing batch 114 of 141 [rank=0, world_size=1]
2025-09-12 19:35:25,831 - INFO - Processing batch 115 of 141 [rank=0, world_size=1]
2025-09-12 19:35:31,567 - INFO - Processing batch 116 of 141 [rank=0, world_size=1]
2025-09-12 19:35:37,308 - INFO - Processing batch 117 of 141 [rank=0, world_size=1]
2025-09-12 19:35:43,041 - INFO - Processing batch 118 of 141 [rank=0, world_size=1]
2025-09-12 19:35:48,768 - INFO - Processing batch 119 of 141 [rank=0, world_size=1]
2025-09-12 19:35:54,502 - INFO - Processing batch 120 of 141 [rank=0, world_size=1]
2025-09-12 19:36:00,226 - INFO - Processing batch 121 of 141 [rank=0, world_size=1]
2025-09-12 19:36:05,952 - INFO - Processing batch 122 of 141 [rank=0, world_size=1]
2025-09-12 19:36:11,684 - INFO - Processing batch 123 of 141 [rank=0, world_size=1]
2025-09-12 19:36:17,411 - INFO - Processing batch 124 of 141 [rank=0, world_size=1]
2025-09-12 19:36:23,140 - INFO - Processing batch 125 of 141 [rank=0, world_size=1]
2025-09-12 19:36:28,869 - INFO - Processing batch 126 of 141 [rank=0, world_size=1]
2025-09-12 19:36:34,607 - INFO - Processing batch 127 of 141 [rank=0, world_size=1]
2025-09-12 19:36:40,332 - INFO - Processing batch 128 of 141 [rank=0, world_size=1]
2025-09-12 19:36:46,060 - INFO - Processing batch 129 of 141 [rank=0, world_size=1]
2025-09-12 19:36:51,779 - INFO - Processing batch 130 of 141 [rank=0, world_size=1]
2025-09-12 19:36:57,499 - INFO - Processing batch 131 of 141 [rank=0, world_size=1]
2025-09-12 19:37:03,228 - INFO - Processing batch 132 of 141 [rank=0, world_size=1]
2025-09-12 19:37:08,957 - INFO - Processing batch 133 of 141 [rank=0, world_size=1]
2025-09-12 19:37:14,686 - INFO - Processing batch 134 of 141 [rank=0, world_size=1]
2025-09-12 19:37:20,419 - INFO - Processing batch 135 of 141 [rank=0, world_size=1]
2025-09-12 19:37:26,146 - INFO - Processing batch 136 of 141 [rank=0, world_size=1]
2025-09-12 19:37:31,875 - INFO - Processing batch 137 of 141 [rank=0, world_size=1]
2025-09-12 19:37:37,607 - INFO - Processing batch 138 of 141 [rank=0, world_size=1]
2025-09-12 19:37:43,335 - INFO - Processing batch 139 of 141 [rank=0, world_size=1]
2025-09-12 19:37:49,067 - INFO - Processing batch 140 of 141 [rank=0, world_size=1]
2025-09-12 19:37:54,797 - INFO - Processing batch 141 of 141 [rank=0, world_size=1]
2025-09-12 19:38:00,532 - INFO - Processing strand: negative
2025-09-12 19:38:01,862 - INFO - Processing 4537 windows in 141 batches of size 32
2025-09-12 19:38:01,863 - INFO - Processing batch 1 of 141 [rank=0, world_size=1]
2025-09-12 19:38:07,767 - INFO - Processing batch 2 of 141 [rank=0, world_size=1]
2025-09-12 19:38:13,668 - INFO - Processing batch 3 of 141 [rank=0, world_size=1]
2025-09-12 19:38:19,583 - INFO - Processing batch 4 of 141 [rank=0, world_size=1]
2025-09-12 19:38:25,501 - INFO - Processing batch 5 of 141 [rank=0, world_size=1]
2025-09-12 19:38:31,424 - INFO - Processing batch 6 of 141 [rank=0, world_size=1]
2025-09-12 19:38:37,345 - INFO - Processing batch 7 of 141 [rank=0, world_size=1]
2025-09-12 19:38:43,267 - INFO - Processing batch 8 of 141 [rank=0, world_size=1]
2025-09-12 19:38:49,182 - INFO - Processing batch 9 of 141 [rank=0, world_size=1]
2025-09-12 19:38:55,102 - INFO - Processing batch 10 of 141 [rank=0, world_size=1]
2025-09-12 19:39:01,021 - INFO - Processing batch 11 of 141 [rank=0, world_size=1]
2025-09-12 19:39:06,940 - INFO - Processing batch 12 of 141 [rank=0, world_size=1]
2025-09-12 19:39:12,863 - INFO - Processing batch 13 of 141 [rank=0, world_size=1]
2025-09-12 19:39:18,775 - INFO - Processing batch 14 of 141 [rank=0, world_size=1]
2025-09-12 19:39:24,690 - INFO - Processing batch 15 of 141 [rank=0, world_size=1]
2025-09-12 19:39:30,608 - INFO - Processing batch 16 of 141 [rank=0, world_size=1]
2025-09-12 19:39:36,530 - INFO - Processing batch 17 of 141 [rank=0, world_size=1]
2025-09-12 19:39:42,451 - INFO - Processing batch 18 of 141 [rank=0, world_size=1]
2025-09-12 19:39:48,367 - INFO - Processing batch 19 of 141 [rank=0, world_size=1]
2025-09-12 19:39:54,280 - INFO - Processing batch 20 of 141 [rank=0, world_size=1]
2025-09-12 19:40:00,197 - INFO - Processing batch 21 of 141 [rank=0, world_size=1]
2025-09-12 19:40:06,120 - INFO - Processing batch 22 of 141 [rank=0, world_size=1]
2025-09-12 19:40:12,038 - INFO - Processing batch 23 of 141 [rank=0, world_size=1]
2025-09-12 19:40:17,952 - INFO - Processing batch 24 of 141 [rank=0, world_size=1]
2025-09-12 19:40:23,870 - INFO - Processing batch 25 of 141 [rank=0, world_size=1]
2025-09-12 19:40:29,789 - INFO - Processing batch 26 of 141 [rank=0, world_size=1]
2025-09-12 19:40:35,533 - INFO - Processing batch 27 of 141 [rank=0, world_size=1]
2025-09-12 19:40:41,263 - INFO - Processing batch 28 of 141 [rank=0, world_size=1]
2025-09-12 19:40:46,996 - INFO - Processing batch 29 of 141 [rank=0, world_size=1]
2025-09-12 19:40:52,730 - INFO - Processing batch 30 of 141 [rank=0, world_size=1]
2025-09-12 19:40:58,461 - INFO - Processing batch 31 of 141 [rank=0, world_size=1]
2025-09-12 19:41:04,192 - INFO - Processing batch 32 of 141 [rank=0, world_size=1]
2025-09-12 19:41:09,926 - INFO - Processing batch 33 of 141 [rank=0, world_size=1]
2025-09-12 19:41:15,654 - INFO - Processing batch 34 of 141 [rank=0, world_size=1]
2025-09-12 19:41:21,390 - INFO - Processing batch 35 of 141 [rank=0, world_size=1]
2025-09-12 19:41:27,131 - INFO - Processing batch 36 of 141 [rank=0, world_size=1]
2025-09-12 19:41:32,865 - INFO - Processing batch 37 of 141 [rank=0, world_size=1]
2025-09-12 19:41:38,592 - INFO - Processing batch 38 of 141 [rank=0, world_size=1]
2025-09-12 19:41:44,330 - INFO - Processing batch 39 of 141 [rank=0, world_size=1]
2025-09-12 19:41:50,063 - INFO - Processing batch 40 of 141 [rank=0, world_size=1]
2025-09-12 19:41:55,788 - INFO - Processing batch 41 of 141 [rank=0, world_size=1]
2025-09-12 19:42:01,519 - INFO - Processing batch 42 of 141 [rank=0, world_size=1]
2025-09-12 19:42:07,249 - INFO - Processing batch 43 of 141 [rank=0, world_size=1]
2025-09-12 19:42:12,989 - INFO - Processing batch 44 of 141 [rank=0, world_size=1]
2025-09-12 19:42:18,729 - INFO - Processing batch 45 of 141 [rank=0, world_size=1]
2025-09-12 19:42:24,463 - INFO - Processing batch 46 of 141 [rank=0, world_size=1]
2025-09-12 19:42:30,191 - INFO - Processing batch 47 of 141 [rank=0, world_size=1]
2025-09-12 19:42:35,933 - INFO - Processing batch 48 of 141 [rank=0, world_size=1]
2025-09-12 19:42:41,659 - INFO - Processing batch 49 of 141 [rank=0, world_size=1]
2025-09-12 19:42:47,390 - INFO - Processing batch 50 of 141 [rank=0, world_size=1]
2025-09-12 19:42:53,129 - INFO - Processing batch 51 of 141 [rank=0, world_size=1]
2025-09-12 19:42:58,862 - INFO - Processing batch 52 of 141 [rank=0, world_size=1]
2025-09-12 19:43:04,591 - INFO - Processing batch 53 of 141 [rank=0, world_size=1]
2025-09-12 19:43:10,330 - INFO - Processing batch 54 of 141 [rank=0, world_size=1]
2025-09-12 19:43:16,072 - INFO - Processing batch 55 of 141 [rank=0, world_size=1]
2025-09-12 19:43:21,810 - INFO - Processing batch 56 of 141 [rank=0, world_size=1]
2025-09-12 19:43:27,548 - INFO - Processing batch 57 of 141 [rank=0, world_size=1]
2025-09-12 19:43:33,280 - INFO - Processing batch 58 of 141 [rank=0, world_size=1]
2025-09-12 19:43:39,011 - INFO - Processing batch 59 of 141 [rank=0, world_size=1]
2025-09-12 19:43:44,751 - INFO - Processing batch 60 of 141 [rank=0, world_size=1]
2025-09-12 19:43:50,495 - INFO - Processing batch 61 of 141 [rank=0, world_size=1]
2025-09-12 19:43:56,230 - INFO - Processing batch 62 of 141 [rank=0, world_size=1]
2025-09-12 19:44:01,955 - INFO - Processing batch 63 of 141 [rank=0, world_size=1]
2025-09-12 19:44:07,690 - INFO - Processing batch 64 of 141 [rank=0, world_size=1]
2025-09-12 19:44:13,422 - INFO - Processing batch 65 of 141 [rank=0, world_size=1]
2025-09-12 19:44:19,153 - INFO - Processing batch 66 of 141 [rank=0, world_size=1]
2025-09-12 19:44:24,891 - INFO - Processing batch 67 of 141 [rank=0, world_size=1]
2025-09-12 19:44:30,630 - INFO - Processing batch 68 of 141 [rank=0, world_size=1]
2025-09-12 19:44:36,371 - INFO - Processing batch 69 of 141 [rank=0, world_size=1]
2025-09-12 19:44:42,110 - INFO - Processing batch 70 of 141 [rank=0, world_size=1]
2025-09-12 19:44:47,844 - INFO - Processing batch 71 of 141 [rank=0, world_size=1]
2025-09-12 19:44:53,576 - INFO - Processing batch 72 of 141 [rank=0, world_size=1]
2025-09-12 19:44:59,309 - INFO - Processing batch 73 of 141 [rank=0, world_size=1]
2025-09-12 19:45:05,051 - INFO - Processing batch 74 of 141 [rank=0, world_size=1]
2025-09-12 19:45:10,794 - INFO - Processing batch 75 of 141 [rank=0, world_size=1]
2025-09-12 19:45:16,533 - INFO - Processing batch 76 of 141 [rank=0, world_size=1]
2025-09-12 19:45:22,270 - INFO - Processing batch 77 of 141 [rank=0, world_size=1]
2025-09-12 19:45:28,011 - INFO - Processing batch 78 of 141 [rank=0, world_size=1]
2025-09-12 19:45:33,750 - INFO - Processing batch 79 of 141 [rank=0, world_size=1]
2025-09-12 19:45:39,491 - INFO - Processing batch 80 of 141 [rank=0, world_size=1]
2025-09-12 19:45:45,237 - INFO - Processing batch 81 of 141 [rank=0, world_size=1]
2025-09-12 19:45:50,969 - INFO - Processing batch 82 of 141 [rank=0, world_size=1]
2025-09-12 19:45:56,702 - INFO - Processing batch 83 of 141 [rank=0, world_size=1]
2025-09-12 19:46:02,430 - INFO - Processing batch 84 of 141 [rank=0, world_size=1]
2025-09-12 19:46:08,162 - INFO - Processing batch 85 of 141 [rank=0, world_size=1]
2025-09-12 19:46:13,874 - INFO - Processing batch 86 of 141 [rank=0, world_size=1]
2025-09-12 19:46:19,609 - INFO - Processing batch 87 of 141 [rank=0, world_size=1]
2025-09-12 19:46:25,347 - INFO - Processing batch 88 of 141 [rank=0, world_size=1]
2025-09-12 19:46:31,076 - INFO - Processing batch 89 of 141 [rank=0, world_size=1]
2025-09-12 19:46:36,804 - INFO - Processing batch 90 of 141 [rank=0, world_size=1]
2025-09-12 19:46:42,529 - INFO - Processing batch 91 of 141 [rank=0, world_size=1]
2025-09-12 19:46:48,269 - INFO - Processing batch 92 of 141 [rank=0, world_size=1]
2025-09-12 19:46:54,002 - INFO - Processing batch 93 of 141 [rank=0, world_size=1]
2025-09-12 19:46:59,731 - INFO - Processing batch 94 of 141 [rank=0, world_size=1]
2025-09-12 19:47:05,469 - INFO - Processing batch 95 of 141 [rank=0, world_size=1]
2025-09-12 19:47:11,211 - INFO - Processing batch 96 of 141 [rank=0, world_size=1]
2025-09-12 19:47:16,949 - INFO - Processing batch 97 of 141 [rank=0, world_size=1]
2025-09-12 19:47:22,686 - INFO - Processing batch 98 of 141 [rank=0, world_size=1]
2025-09-12 19:47:28,416 - INFO - Processing batch 99 of 141 [rank=0, world_size=1]
2025-09-12 19:47:34,149 - INFO - Processing batch 100 of 141 [rank=0, world_size=1]
2025-09-12 19:47:39,882 - INFO - Processing batch 101 of 141 [rank=0, world_size=1]
2025-09-12 19:47:45,617 - INFO - Processing batch 102 of 141 [rank=0, world_size=1]
2025-09-12 19:47:51,340 - INFO - Processing batch 103 of 141 [rank=0, world_size=1]
2025-09-12 19:47:57,065 - INFO - Processing batch 104 of 141 [rank=0, world_size=1]
2025-09-12 19:48:02,793 - INFO - Processing batch 105 of 141 [rank=0, world_size=1]
2025-09-12 19:48:08,528 - INFO - Processing batch 106 of 141 [rank=0, world_size=1]
2025-09-12 19:48:14,257 - INFO - Processing batch 107 of 141 [rank=0, world_size=1]
2025-09-12 19:48:19,982 - INFO - Processing batch 108 of 141 [rank=0, world_size=1]
2025-09-12 19:48:25,706 - INFO - Processing batch 109 of 141 [rank=0, world_size=1]
2025-09-12 19:48:31,433 - INFO - Processing batch 110 of 141 [rank=0, world_size=1]
2025-09-12 19:48:37,169 - INFO - Processing batch 111 of 141 [rank=0, world_size=1]
2025-09-12 19:48:42,901 - INFO - Processing batch 112 of 141 [rank=0, world_size=1]
2025-09-12 19:48:48,629 - INFO - Processing batch 113 of 141 [rank=0, world_size=1]
2025-09-12 19:48:54,358 - INFO - Processing batch 114 of 141 [rank=0, world_size=1]
2025-09-12 19:49:00,082 - INFO - Processing batch 115 of 141 [rank=0, world_size=1]
2025-09-12 19:49:05,808 - INFO - Processing batch 116 of 141 [rank=0, world_size=1]
2025-09-12 19:49:11,534 - INFO - Processing batch 117 of 141 [rank=0, world_size=1]
2025-09-12 19:49:17,266 - INFO - Processing batch 118 of 141 [rank=0, world_size=1]
2025-09-12 19:49:22,988 - INFO - Processing batch 119 of 141 [rank=0, world_size=1]
2025-09-12 19:49:28,718 - INFO - Processing batch 120 of 141 [rank=0, world_size=1]
2025-09-12 19:49:34,451 - INFO - Processing batch 121 of 141 [rank=0, world_size=1]
2025-09-12 19:49:40,188 - INFO - Processing batch 122 of 141 [rank=0, world_size=1]
2025-09-12 19:49:45,918 - INFO - Processing batch 123 of 141 [rank=0, world_size=1]
2025-09-12 19:49:51,642 - INFO - Processing batch 124 of 141 [rank=0, world_size=1]
2025-09-12 19:49:57,369 - INFO - Processing batch 125 of 141 [rank=0, world_size=1]
2025-09-12 19:50:03,103 - INFO - Processing batch 126 of 141 [rank=0, world_size=1]
2025-09-12 19:50:08,827 - INFO - Processing batch 127 of 141 [rank=0, world_size=1]
2025-09-12 19:50:14,553 - INFO - Processing batch 128 of 141 [rank=0, world_size=1]
2025-09-12 19:50:20,283 - INFO - Processing batch 129 of 141 [rank=0, world_size=1]
2025-09-12 19:50:26,000 - INFO - Processing batch 130 of 141 [rank=0, world_size=1]
2025-09-12 19:50:31,731 - INFO - Processing batch 131 of 141 [rank=0, world_size=1]
2025-09-12 19:50:37,468 - INFO - Processing batch 132 of 141 [rank=0, world_size=1]
2025-09-12 19:50:43,200 - INFO - Processing batch 133 of 141 [rank=0, world_size=1]
2025-09-12 19:50:48,932 - INFO - Processing batch 134 of 141 [rank=0, world_size=1]
2025-09-12 19:50:54,664 - INFO - Processing batch 135 of 141 [rank=0, world_size=1]
2025-09-12 19:51:00,398 - INFO - Processing batch 136 of 141 [rank=0, world_size=1]
2025-09-12 19:51:06,335 - INFO - Processing batch 137 of 141 [rank=0, world_size=1]
2025-09-12 19:51:12,065 - INFO - Processing batch 138 of 141 [rank=0, world_size=1]
2025-09-12 19:51:17,792 - INFO - Processing batch 139 of 141 [rank=0, world_size=1]
2025-09-12 19:51:23,533 - INFO - Processing batch 140 of 141 [rank=0, world_size=1]
2025-09-12 19:51:29,264 - INFO - Processing batch 141 of 141 [rank=0, world_size=1]
2025-09-12 19:51:34,991 - INFO - Loading completed predictions from results/pipeline/predictions.zarr/predictions.0.zarr (rank=0, world_size=1)
2025-09-12 19:51:35,260 - INFO - Complete predictions dataset:
<xarray.DataTree>
Group: /
├── Group: /negative
│       Dimensions:              (sequence: 18585056, token: 17, feature: 5)
│       Coordinates:
│         * feature              (feature) <U15 300B 'intergenic' ... 'three_prime_utr'
│         * token                (token) <U17 1kB 'intergenic' ... 'U-three_prime_utr'
│         * sequence             (sequence) int64 149MB 18447840 18447841 ... 130527
│       Data variables:
│           token_logits         (sequence, token) float32 1GB ...
│           feature_predictions  (sequence) int64 149MB ...
│           token_predictions    (sequence) int64 149MB ...
│           feature_logits       (sequence, feature) float32 372MB ...
│       Attributes:
│           strand:            negative
│           species_id:        athaliana
│           chromosome_id:     4
│           model_checkpoint:  plantcad/GeneCAD-l8-d768-PC2-Large
│           model_path:        kuleshov-group/PlantCAD2-Large-l48-d1536
└── Group: /positive
        Dimensions:              (sequence: 18585056, token: 17, feature: 5)
        Coordinates:
          * feature              (feature) <U15 300B 'intergenic' ... 'three_prime_utr'
          * token                (token) <U17 1kB 'intergenic' ... 'U-three_prime_utr'
          * sequence             (sequence) int64 149MB 0 1 2 ... 18585054 18585055
        Data variables:
            token_logits         (sequence, token) float32 1GB ...
            feature_predictions  (sequence) int64 149MB ...
            feature_logits       (sequence, feature) float32 372MB ...
            token_predictions    (sequence) int64 149MB ...
        Attributes:
            strand:            positive
            species_id:        athaliana
            chromosome_id:     4
            model_checkpoint:  plantcad/GeneCAD-l8-d768-PC2-Large
            model_path:        kuleshov-group/PlantCAD2-Large-l48-d1536
2025-09-12 19:51:35,260 - INFO - Done
python scripts/predict.py detect_intervals \
  --input-dir results/pipeline/predictions.zarr \
  --output results/pipeline/intervals.zarr \
  --decoding-methods "direct,viterbi" \
  --remove-incomplete-features yes
2025-09-12 19:51:42,074 - INFO - Detecting intervals from rank files in results/pipeline/predictions.zarr and saving to results/pipeline/intervals.zarr
2025-09-12 19:51:42,074 - INFO - Found 1 rank prediction files: ['results/pipeline/predictions.zarr/predictions.0.zarr']
2025-09-12 19:51:42,074 - INFO - Processing strand: positive
2025-09-12 19:51:42,354 - INFO - Concatenating 1 rank datasets for 'positive' strand along the sequence dimension.
2025-09-12 19:51:44,042 - INFO - Processing strand: negative
2025-09-12 19:51:44,302 - INFO - Concatenating 1 rank datasets for 'negative' strand along the sequence dimension.
2025-09-12 19:51:46,196 - INFO - Concatenating 2 datasets along the strand dimension.
2025-09-12 19:51:46,534 - INFO - Concatenated sequence predictions dataset:
<xarray.Dataset> Size: 1GB
Dimensions:              (strand: 2, sequence: 18585056, feature: 5, token: 17)
Coordinates:
  * strand               (strand) object 16B 'positive' 'negative'
  * feature              (feature) <U15 300B 'intergenic' ... 'three_prime_utr'
  * token                (token) <U17 1kB 'intergenic' ... 'U-three_prime_utr'
  * sequence             (sequence) int64 149MB 0 1 2 ... 18585054 18585055
Data variables:
    feature_predictions  (strand, sequence) int64 297MB 0 0 0 0 0 ... 0 0 0 0 0
    feature_logits       (strand, sequence, feature) float32 743MB 4.312 ... ...
Attributes:
    species_id:        athaliana
    chromosome_id:     4
    model_checkpoint:  plantcad/GeneCAD-l8-d768-PC2-Large
    model_path:        kuleshov-group/PlantCAD2-Large-l48-d1536
2025-09-12 19:51:46,537 - INFO - Detecting intervals
2025-09-12 19:51:46,537 - INFO - Inferring regions from predicted labels
2025-09-12 19:51:46,537 - INFO - Running decoding methods: ['direct', 'viterbi']
2025-09-12 19:51:46,538 - INFO - Running direct decoding for 'positive' strand
2025-09-12 19:51:48,173 - INFO - Running viterbi decoding for 'positive' strand
2025-09-12 19:51:48,313 - INFO - Running viterbi decoding (alpha=None)
2025-09-12 19:51:58,857 - INFO - Running direct decoding for 'negative' strand
2025-09-12 19:52:00,470 - INFO - Running viterbi decoding for 'negative' strand
2025-09-12 19:52:00,766 - INFO - Running viterbi decoding (alpha=None)
2025-09-12 19:52:09,327 - INFO - Region intervals detected:
          entity_index     start      stop    strand decoding      entity_name
interval
0                    1     13518     13518  positive   direct       transcript
1                    1     13523     16074  positive   direct       transcript
2                    1     16076     16077  positive   direct       transcript
3                    1     16084     16084  positive   direct       transcript
4                    1     17747     17747  positive   direct       transcript
...                ...       ...       ...       ...      ...              ...
231189               6  18557202  18557537  negative  viterbi  three_prime_utr
231190               6  18559793  18559924  negative  viterbi  three_prime_utr
231191               6  18560871  18561204  negative  viterbi  three_prime_utr
231192               6  18571381  18571680  negative  viterbi  three_prime_utr
231193               6  18580811  18581083  negative  viterbi  three_prime_utr

[231194 rows x 6 columns]
2025-09-12 19:52:09,327 - INFO - Region interval info:

2025-09-12 19:52:09,351 - INFO - Merging sequence and interval predictions
2025-09-12 19:52:09,355 - INFO - Final results:
<xarray.DataTree>
Group: /
├── Group: /sequences
│       Dimensions:              (strand: 2, sequence: 18585056, feature: 5, token: 17)
│       Coordinates:
│         * strand               (strand) object 16B 'positive' 'negative'
│         * feature              (feature) <U15 300B 'intergenic' ... 'three_prime_utr'
│         * token                (token) <U17 1kB 'intergenic' ... 'U-three_prime_utr'
│         * sequence             (sequence) int64 149MB 0 1 2 ... 18585054 18585055
│       Data variables:
│           feature_predictions  (strand, sequence) int64 297MB 0 0 0 0 0 ... 0 0 0 0 0
│           feature_logits       (strand, sequence, feature) float32 743MB 4.312 ... ...
│       Attributes:
│           species_id:        athaliana
│           chromosome_id:     4
│           model_checkpoint:  plantcad/GeneCAD-l8-d768-PC2-Large
│           model_path:        kuleshov-group/PlantCAD2-Large-l48-d1536
└── Group: /intervals
        Dimensions:       (interval: 231194)
        Coordinates:
          * interval      (interval) int64 2MB 0 1 2 3 4 ... 231190 231191 231192 231193
        Data variables:
            entity_index  (interval) int64 2MB 1 1 1 1 1 1 1 1 1 1 ... 6 6 6 6 6 6 6 6 6
            start         (interval) int64 2MB 13518 13523 16076 ... 18571381 18580811
            stop          (interval) int64 2MB 13518 16074 16077 ... 18571680 18581083
            strand        (interval) object 2MB 'positive' 'positive' ... 'negative'
            decoding      (interval) object 2MB 'direct' 'direct' ... 'viterbi'
            entity_name   (interval) object 2MB 'transcript' ... 'three_prime_utr'
        Attributes:
            interval_entity_names:  ['transcript', 'exon', 'intron', 'five_prime_utr'...
            species_id:             athaliana
            chromosome_id:          4
            model_checkpoint:       plantcad/GeneCAD-l8-d768-PC2-Large
            model_path:             kuleshov-group/PlantCAD2-Large-l48-d1536
2025-09-12 19:52:09,355 - INFO - Saving results to output path results/pipeline/intervals.zarr
2025-09-12 19:52:10,198 - INFO - Done
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 231194 entries, 0 to 231193
Data columns (total 6 columns):
 #   Column        Non-Null Count   Dtype
---  ------        --------------   -----
 0   entity_index  231194 non-null  int64
 1   start         231194 non-null  int64
 2   stop          231194 non-null  int64
 3   strand        231194 non-null  object
 4   decoding      231194 non-null  object
 5   entity_name   231194 non-null  object
dtypes: int64(3), object(3)
memory usage: 10.6+ MB
python scripts/predict.py export_gff \
  --input results/pipeline/intervals.zarr \
  --output results/pipeline/predictions__raw.gff \
  --decoding-method viterbi \
  --min-transcript-length 3 \
  --strip-introns yes
2025-09-12 19:52:16,606 - INFO - Loading predictions from results/pipeline/intervals.zarr
2025-09-12 19:52:16,763 - INFO - Loaded intervals for chromosome: 4
2025-09-12 19:52:16,763 - INFO - Converting interval predictions to DataFrame
2025-09-12 19:52:16,902 - INFO - Filtered intervals to 71017 rows using decoding method: viterbi
2025-09-12 19:52:16,902 - INFO - Grouping intervals by transcript
2025-09-12 19:52:16,906 - INFO - Filtered out 0 transcripts below minimum length of 3bp
2025-09-12 19:52:16,906 - INFO - Retained 3777 transcripts
100%|██████████| 3777/3777 [00:15<00:00, 244.52it/s]
2025-09-12 19:52:32,360 - INFO - Grouped intervals into 3777 transcripts/genes.
2025-09-12 19:52:32,361 - INFO - Generating GFF3 output for 3777 genes on 4
2025-09-12 19:52:36,199 - INFO - Writing 36220 lines to results/pipeline/predictions__raw.gff
2025-09-12 19:52:36,212 - INFO - GFF export complete
python scripts/gff.py filter_to_min_feature_length \
  --input results/pipeline/predictions__raw.gff \
  --output results/pipeline/predictions__raw__feat_len_2.gff \
  --feature-types "five_prime_UTR,three_prime_UTR,CDS" \
  --min-length 2
2025-09-12 19:52:38,346 - INFO - Filtering results/pipeline/predictions__raw.gff to remove ['five_prime_UTR', 'three_prime_UTR', 'CDS'] features shorter than 2 bp
2025-09-12 19:52:38,346 - INFO - Loading GFF file results/pipeline/predictions__raw.gff
2025-09-12 19:52:38,448 - INFO - Loading complete: 36219 records found
2025-09-12 19:52:38,455 - INFO - Validated feature types: ['CDS', 'five_prime_UTR', 'three_prime_UTR'] (all valid)
2025-09-12 19:52:38,457 - INFO - Found 274 small features to remove
2025-09-12 19:53:07,549 - INFO - Boundary updates:
2025-09-12 19:53:07,549 - INFO -   - Genes: 194/3777 (5.1%) had boundaries updated
2025-09-12 19:53:07,549 - INFO -   - Transcripts: 194/3777 (5.1%) had boundaries updated
2025-09-12 19:53:07,549 - INFO - Writing GFF to results/pipeline/predictions__raw__feat_len_2.gff
2025-09-12 19:53:07,649 - INFO - Complete: 35945 records written
2025-09-12 19:53:07,649 - INFO - Filter complete: 274 features removed, 35945/36219 records retained
python scripts/gff.py filter_to_min_gene_length \
  --input results/pipeline/predictions__raw__feat_len_2.gff \
  --output results/pipeline/predictions__raw__feat_len_2__gene_len_30.gff \
  --min-length 30
2025-09-12 19:53:08,334 - INFO - Filtering results/pipeline/predictions__raw__feat_len_2.gff to remove genes shorter than 30 bp
2025-09-12 19:53:08,334 - INFO - Loading GFF file results/pipeline/predictions__raw__feat_len_2.gff
2025-09-12 19:53:08,434 - INFO - Loading complete: 35945 records found
2025-09-12 19:53:08,444 - INFO - Found 3777 gene features to check for length
2025-09-12 19:53:08,445 - INFO - Found 0 genes shorter than 30 bp
2025-09-12 19:53:08,450 - INFO - Removing 0 genes directly (too short)
2025-09-12 19:53:08,450 - INFO - Removing 0 features indirectly (parent gene too short)
2025-09-12 19:53:08,450 - INFO - Total features removed: 0
2025-09-12 19:53:08,450 - INFO - Writing GFF to results/pipeline/predictions__raw__feat_len_2__gene_len_30.gff
2025-09-12 19:53:08,547 - INFO - Complete: 35945 records written
2025-09-12 19:53:08,547 - INFO - Filter complete: 35945/35945 records retained
python scripts/gff.py filter_to_valid_genes \
  --input results/pipeline/predictions__raw__feat_len_2__gene_len_30.gff \
  --output results/pipeline/predictions__raw__feat_len_2__gene_len_30__has_req_feats.gff \
  --require-utrs yes
2025-09-12 19:53:09,220 - INFO - Filtering results/pipeline/predictions__raw__feat_len_2__gene_len_30.gff to keep only valid transcripts and genes
2025-09-12 19:53:09,220 - INFO - Requiring five_prime_UTR, CDS, and three_prime_UTR for valid transcripts
2025-09-12 19:53:09,220 - INFO - Loading GFF file results/pipeline/predictions__raw__feat_len_2__gene_len_30.gff
2025-09-12 19:53:09,321 - INFO - Loading complete: 35945 records found
2025-09-12 19:53:09,331 - INFO - Found 3777 mRNA features
2025-09-12 19:53:15,001 - INFO - Found 3591 valid mRNAs and 186 invalid mRNAs
2025-09-12 19:53:15,014 - INFO - Removed 186 invalid mRNAs, 472 child features, 658 total features
2025-09-12 19:53:15,016 - INFO - Found 3777 gene features
2025-09-12 19:53:15,019 - INFO - Found 186 genes with no valid transcripts
2025-09-12 19:53:15,030 - INFO - Removed 186 invalid genes, 0 child features, 186 total features
2025-09-12 19:53:15,030 - INFO - Writing GFF to results/pipeline/predictions__raw__feat_len_2__gene_len_30__has_req_feats.gff
2025-09-12 19:53:15,125 - INFO - Complete: 35101 records written
2025-09-12 19:53:15,125 - INFO - Filter complete: 35101/35945 records retained
cp results/pipeline/predictions__raw__feat_len_2__gene_len_30__has_req_feats.gff results/predictions.gff
